<!-- Modal de cadastro de novo empréstimo -->
<div class="fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center p-4 z-50">
    <div class="w-full max-w-lg bg-white rounded-2xl shadow-2xl border border-slate-200">
        <form [formGroup]="formulario" (ngSubmit)="aoEnviar()">
            <div class="p-6 border-b border-slate-200">
                <h3 class="text-xl font-bold text-slate-900">Adicionar Novo Empréstimo</h3>
            </div>
            <div class="p-6 space-y-4">

                <!-- Nome do devedor -->
                <div>
                    <label for="borrowerName" class="block text-sm font-medium text-slate-700 mb-1">Nome</label>
                    <input type="text" id="borrowerName" formControlName="borrowerName"
                        class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-slate-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Valor principal -->
                    <div>
                        <label for="principal" class="block text-sm font-medium text-slate-700 mb-1">Valor Principal
                            (R$)</label>
                        <input type="number" id="principal" formControlName="principal" min="0.01"
                            class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-slate-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                    </div>
                    <!-- Taxa de juros mensal -->
                    <div>
                        <label for="interestRate" class="block text-sm font-medium text-slate-700 mb-1">Juros (% ao
                            mês)</label>
                        <input type="number" id="interestRate" formControlName="interestRate" min="0"
                            class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-slate-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                    </div>
                </div>

                <!-- Toggle: Tipo de Juros -->
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">Tipo de Juros</label>
                    <div class="grid grid-cols-2 gap-2 p-1 bg-slate-100 rounded-xl">
                        <!-- Juros Compostos (Tabela Price) -->
                        <button type="button" (click)="formulario.get('tipoJuros')!.setValue('compostos')"
                            class="px-4 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200" [class]="formulario.get('tipoJuros')!.value === 'compostos'
                ? 'bg-white text-blue-700 shadow-md ring-1 ring-blue-100'
                : 'text-slate-500 hover:text-slate-700'">
                            <span class="block text-base leading-tight">Compostos</span>
                            <span class="block text-xs font-normal opacity-75 leading-tight">Tabela Price</span>
                        </button>
                        <!-- Juros Simples -->
                        <button type="button" (click)="formulario.get('tipoJuros')!.setValue('simples')"
                            class="px-4 py-2.5 rounded-lg text-sm font-semibold transition-all duration-200" [class]="formulario.get('tipoJuros')!.value === 'simples'
                ? 'bg-white text-blue-700 shadow-md ring-1 ring-blue-100'
                : 'text-slate-500 hover:text-slate-700'">
                            <span class="block text-base leading-tight">Simples</span>
                            <span class="block text-xs font-normal opacity-75 leading-tight">P × (1 + i × n)</span>
                        </button>
                    </div>

                    <!-- Explicação do tipo selecionado -->
                    @if (formulario.get('tipoJuros')!.value === 'compostos') {
                    <p class="text-xs text-slate-500 mt-2 ml-1">
                        Juros incidem sobre o saldo devedor decrescente. Parcelas iguais, total menor.
                    </p>
                    } @else {
                    <p class="text-xs text-slate-500 mt-2 ml-1">
                        Juros incidem sobre o valor original em todos os meses. Parcelas iguais, total maior.
                    </p>
                    }
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <!-- Prazo em meses -->
                    <div>
                        <label for="paymentTermInMonths" class="block text-sm font-medium text-slate-700 mb-1">Prazo
                            (meses)</label>
                        <input type="number" id="paymentTermInMonths" formControlName="paymentTermInMonths" min="1"
                            class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-slate-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                    </div>
                    <!-- Dia de vencimento -->
                    <div>
                        <label for="paymentDay" class="block text-sm font-medium text-slate-700 mb-1">Dia do
                            Pagamento</label>
                        <input type="number" id="paymentDay" formControlName="paymentDay" min="1" max="30"
                            class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-slate-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                    </div>
                </div>

                <!-- Data do empréstimo -->
                <div>
                    <label for="dateLent" class="block text-sm font-medium text-slate-700 mb-1">Data do
                        Empréstimo</label>
                    <input type="date" id="dateLent" formControlName="dateLent"
                        class="w-full bg-white border border-slate-300 rounded-lg px-3 py-2 text-slate-900 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none shadow-sm">
                </div>
            </div>

            <!-- Ações do formulário -->
            <div class="p-6 bg-slate-50 flex justify-end gap-4 rounded-b-2xl border-t border-slate-200">
                <button type="button" (click)="cancelar.emit()"
                    class="bg-white border border-slate-200 hover:bg-slate-50 text-slate-700 font-semibold px-4 py-2 rounded-lg transition-colors shadow-sm">Cancelar</button>
                <button type="submit" [disabled]="formulario.invalid"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded-lg transition-colors disabled:bg-slate-300 disabled:cursor-not-allowed shadow-md">Salvar</button>
            </div>
        </form>
    </div>
</div>